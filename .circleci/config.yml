---
version: 2
jobs:
  build:
    docker:
      - image: debian:stretch
    steps:
      - checkout
      - run: echo Hello, world.
      - run: date
      - run: "sleep 30"
      - run: mkdir /code/
      - run: cp artifact /code/artifact
      - store_artifacts:
          path: /code/artifact

  deploy_only:
    docker:
      - image: debian:stretch
    steps:
      - run: echo Deploying only.
  say_hi:
    docker:
      - image: debian:stretch
    steps:
      - run: echo HI

workflows:
  version: 2
  no_artifacts:
    jobs:
      - build:
          filters:
            branches:
              only: test
      - say_hi:
          filters:
            tags:
              only: /^v.*/
      - deploy_only:
          filters:
            branches:
              only: master
